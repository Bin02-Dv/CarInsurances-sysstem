{% extends "base.html" %}
{% load static %}

{% block title %}
    <title>Insurance - Payments</title>
{% endblock %}

{% block Css %}
<link rel="stylesheet" href="{% static 'css/policy-management.css' %}">
{% endblock %}


{% block content %}

<div class="policy-container">
    <header>
        <h1>Payment Management</h1>
        {% comment %} <input type="text" id="searchBar" placeholder="Search Policies..."> {% endcomment %}
        <a href="/payment/"><button class="btn-add">Add New Payment</button></a>
    </header>

    <table>
        <thead>
            <tr>
                <th>Payment ID</th>
                <th>User</th>
                <th>Policy</th>
                <th>Type</th>
                <th>Amount</th>
                <th>Payment Date</th>
                <th>Transaction Refernece</th>
            </tr>
        </thead>
        {% if user.is_superuser %}
        <tbody>
            {% if all_payments %}
            {% for payment in all_payments %}
            <tr>
                <td>{{payment.id}}</td>
                <td>{{payment.user.first_name}}</td>
                <td>{{payment.policy.policy_name}}</td>
                <td>{{payment.policy.policy_type}}</td>
                <td>{{payment.amount}}</td>
                <td>{{payment.payment_date}}</td>
                <td>{{payment.transaction_reference}}</td>
            </tr>
            {% endfor %}
            {% else %}
            <tr>
                <td>###</td>
                <td>No data</td>
                <td>No data</td>
                <td>No data</td>
                <td>No data</td>
                <td>No data</td>
            </tr>
            {% endif %}
        </tbody>
        {% else %}
        <tbody>
            {% if user_payments %}
            {% for payment in user_payments %}
            <tr>
                <td>{{payment.id}}</td>
                <td>{{payment.user.first_name}}</td>
                <td>{{payment.policy.policy_name}}</td>
                <td>{{payment.policy.policy_type}}</td>
                <td>{{payment.amount}}</td>
                <td>{{payment.payment_date}}</td>
                <td>{{payment.transaction_reference}}</td>
            </tr>
            {% endfor %}
            {% else %}
            <tr>
                <td>###</td>
                <td>No data</td>
                <td>No data</td>
                <td>No data</td>
                <td>No data</td>
                <td>No data</td>
            </tr>
            {% endif %}
        </tbody>
        {% endif %}
    </table>
</div>
{% endblock %}